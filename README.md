# testCodexOptimus
For Codex Optimus test task https://docs.google.com/document/d/1PPvRO3v55ehYzGz5bDEy2M20HsX8hNnwI52wRYKhOIc/edit

  Чтобы гарантировать корректную работу бонусной системы данного банковского приложения, необходимо разработать и провести комплексные тесты, охватывающие различные аспекты функциональности. Ниже приведу список проверок и ожидаемые результаты для тестирования:

1. Проверки начисления и обновления баллов(POST /api/customer/{customer_id}/purchase):
   - Покупка на сумму меньше 1000 рублей (например, 999 рублей). Ожидаемый результат: баллы не начисляются.
   - Покупка на сумму значительно превышающую граничные значения (например, 100000 рублей). Ожидаемый результат: корректное начисление баллов в соответствии с суммой покупки.
   - Начисление баллов за покупку на сумму 1000 рублей. Ожидаемый результат: начисление 1 балла.
   - Начисление баллов за покупку на сумму 2000 рублей. Ожидаемый результат: начисление 2 балла.
   - Начисление баллов за покупку на сумму, не кратную 1000 (например, 1500 рублей). Ожидаемый результат: начисление баллов только за полные 1000 рублей.
   - Покупка с отрицательной суммой. Ожидаемый результат: ошибка с сообщением о неверном значении суммы.
   - Покупка без указания суммы. Ожидаемый результат: ошибка с сообщением о недостающем параметре.
   - Отправка запроса на начисление баллов с не числовым значением суммы покупки. Ожидаемый результат: ошибка с соответствующим сообщением.

2. Проверки отображения баллов(GET /api/customer/{customer_id}/points):
   - Запрос текущего количества баллов для нового клиента. Ожидаемый результат: 0 баллов.
   - Запрос текущего количества баллов после одной покупки. Ожидаемый результат: количество баллов соответствует количеству баллов за покупку.
   - Запрос текущего количества баллов после нескольких покупок. Ожидаемый результат: количество баллов соответствует суммарному количеству баллов за все покупки.
   - Запрос для несуществующего 'customer_id'. Ожидаемый результат: ошибка с сообщением о несуществующем клиенте.

3. Проверки расчета скидки(POST /api/discount/calculate):
   - Расчет скидки при 0 баллах (граница перехода к 1%). Ожидаемый результат: скидка 1%.
   - Расчет скидки при 149 баллах (граница перехода к 1%). Ожидаемый результат: скидка 1%.
   - Расчет скидки при 150 баллах (граница перехода к 5%). Ожидаемый результат: скидка 5%.
   - Расчет скидки при 399 баллах (граница перехода к 7%). Ожидаемый результат: скидка 7%.
   - Расчет скидки при 400 баллах (граница перехода к 10%). Ожидаемый результат: скидка 10%.
   - Расчет скидки с отрицательным количеством баллов. Ожидаемый результат: ошибка с сообщением о некорректном количестве баллов.
   - Расчет скидки со слишком большим числом количеством баллов. Ожидаемый результат: ошибка с соответствующим сообщением.
   - Расчет скидки без указания количества баллов. Ожидаемый результат: ошибка с сообщением о недостающем параметре.

     Общие проверки серверной части и проверки БД:

1. Обеспечение консистентности данных:
   - Проверка на соответствие количества баллов в БД после каждой транзакции. Ожидаемый результат: данные в БД соответствуют количеству баллов, возвращаемых API.
   - Проверка на корректное обновление скидки в профиле клиента в БД после изменения количества баллов. Ожидаемый результат: скидка обновлена согласно текущему количеству баллов.

2. Обработка ошибок и исключений:
   - Проверка корректности сообщений об ошибках при отправке некорректных запросов. Ожидаемый результат: получение читаемого сообщения об ошибке.
   - Проверка возврата соответствующих HTTP статусов при ошибочных запросах. Ожидаемый результат: получение соответствующего HTTP статуса ошибки.

3. Обработка параллельных транзакций:
   - Проведение параллельных покупок для одного клиента. Ожидаемый результат: корректное начисление баллов без потерь или дублирования.

4. Безопасность и авторизация:
   - Проверка доступа к API-методам без авторизации или с неверными авторизационными данными. Ожидаемый результат: отказ в доступе.
   - Проверка защищенности данных клиентов при запросах к API. Ожидаемый результат: данные передаются по защищенному соединению.

     Интеграционное тестирование:
   - Проверка, что после совершения покупки и начисления баллов, метод GET /api/customer/{customer_id}/points возвращает обновленное количество баллов. Ожидаемый результат: корректное обновление баллов.
   - Проверка, что метод POST /api/discount/calculate корректно рассчитывает скидку на основе баллов, полученных через GET /api/customer/{customer_id}/points. Ожидаемый результат: корректный расчет скидки на основе полученных баллов.
   - Проверка начисления баллов и расчета скидки для новых клиентов (без баллов). Ожидаемый результат: начисление баллов с нуля и расчет скидки в соответствии с правилами.
   - Проверка взаимодействия API для клиента, переходящего из одного диапазона скидки в другой после покупки. Ожидаемый результат: корректное начисление баллов и пересчет скидки.
   - Проверка, что после совершения нескольких покупок, суммарно составляющих более 1000 рублей. Ожидаемый результат: баллы начисляются за каждую тысячу рублей.
